version: "3.7"

services:
  storeA:
    build:
      context: ../../../fred
      dockerfile: storage.Dockerfile
    image: fred/store:local
    container_name: storeA
    command: --cert "/cert/cert.crt" --key "/cert/key.key" --ca-file "/cert/ca.crt"
    volumes:
      - ../../nase/tls/storeA.crt:/cert/cert.crt
      - ../../nase/tls/storeA.key:/cert/key.key
      - ../../nase/tls/ca.crt:/cert/ca.crt
    networks:
      fredwork:
        ipv4_address: 172.26.0.20

  storeB:
    build:
      context: ../../../fred
      dockerfile: storage.Dockerfile
    image: fred/store:local
    container_name: storeB
    command: --cert "/cert/cert.crt" --key "/cert/key.key" --ca-file "/cert/ca.crt"
    volumes:
      - ../../nase/tls/storeB.crt:/cert/cert.crt
      - ../../nase/tls/storeB.key:/cert/key.key
      - ../../nase/tls/ca.crt:/cert/ca.crt
    networks:
      fredwork:
        ipv4_address: 172.26.0.21

  storeC:
    build:
      context: ../../../fred
      dockerfile: storage.Dockerfile
    image: fred/store:local
    container_name: storeC
    command: --cert "/cert/cert.crt" --key "/cert/key.key" --ca-file "/cert/ca.crt"
    volumes:
      - ../../nase/tls/storeC.crt:/cert/cert.crt
      - ../../nase/tls/storeC.key:/cert/key.key
      - ../../nase/tls/ca.crt:/cert/ca.crt
    networks:
      fredwork:
        ipv4_address: 172.26.0.22

networks:
  fredwork:
    external: true
# docker network create fredwork --gateway 172.26.0.1 --subnet 172.26.0.0/16
